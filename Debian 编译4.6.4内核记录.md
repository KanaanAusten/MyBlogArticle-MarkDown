# Debian 编译4.6.4内核记录
## 1. 下载源代码
源代码去[官网](https://www.kernel.org/)下载,下载最新的`stable`版本即可.
## 2. 安装编译所需要的工具
一般来说,只需要安装`libncurses5-dev`和`bc`这两个包即可正确的编译.
ps:不安装的话配置会失败.
## 3. 配置
### 3.1 解压源代码
源代码下载下来一般都是`xz`格式的包,解压命令如下:

```
xz -d ***.tar.xz
```

ps: `xz`命令需要手动安装.`sudo apt install xz`

然后会在当前目录生成一个`tar`包.解压:

```
tar -xvf ***.tar
```

之后会生成一个包含内核的文件夹.进入这个文件夹

### 3.2 清理上次的编译文件(第一次操作可以pass)

下面操作默认使用root权限.使用su命令提升权限到root.

```
make mrproper
```

### 3.3 配置 `.config` 文件

```
make menuconfig
```

这一步会进入一个界面让你选择需要编译哪些模块,默认就行,随意.然后`save`.

## 4. 编译

首先确定机器的核心数量:

```
cat /proc/cpuinfo | grep "cpu cores"
```
然后编译:

```
make -j2
```
ps: -j 代表使用的核心数量,可以加快编译速度.这一步很慢,跟机器性能有关.

## 5. 安装

### 5.1 安装模块

```
make modules_install
```
ps:这一步一会就能搞定.

### 5.2 安装内核

```
make install
```
这一步会自动复制内核镜像、添加grub引导.

## 6. 重启

```
reboot
```
不出意外,基本上可以在引导项看到最新编译的内核了.


